# 💻 Cpp-Coroutine

基于 **Windows Fiber**、**向量化异常处理 (VEH)** 及 **CXX17** 实现的 C++ 协程库

> ⚠️ 本项目主要是一个学习目的的**练手项目**。本项目旨在理解协程底层的调度、上下文切换和异常处理机制。因此，本项目**仅限于 Windows 平台**，且不会提供专业级的性能保证或长期的社区支持。

## ✨ 核心功能

*   **用户态协程调度**: 提供协程的创建、执行、挂起和恢复等基本调度功能
*   **异步操作支持**: 内置了基于时间的异步睡眠 (`AsyncSleep`)
*   **Future/Promise 模式**: 允许从协程外部安全地获取执行结果或捕获到的异常

## 🔧 实现原理

*   **上下文切换**: 基于 Windows `Fiber` API，实现用户态的轻量级上下文切换，避免了内核态转换的开销
*   **异常捕获**: 通过向量化异常处理 (`VEH`) 捕获协程中的 C++ 及结构化异常，并将其转化为数据传递给 `Promise`，防止程序崩溃
*   **调度模型**: 采用单线程事件循环，通过 `std::deque` 管理可运行的协程 (FIFO)，并用优先队列处理异步睡眠任务

## 🛠️ 快速开始

本项目使用 xmake 进行构建

```bash
# 构建项目
xmake

# 运行基准测试
xmake run benchmark
```

## 🗺️ 未来计划

### 🚀 Cpp-Coroutine 未来开发计划

| 优先级 | 分类 | 主要任务 |
| :---: | :--- | :--- |
| ⚡ | **C++20 协程支持** | - [ ] **设计 `Task<T>`**<br>- [ ] **封装 Awaitables** |
| ⚡⚡⚡⚡ | **调度器与并发** | - [ ] **多线程调度器**<br>- [ ] **集成 IOCP** |
| ⚡⚡ | **协程同步原语** | - [ ] **异步互斥锁（`AsyncMutex`）**<br>- [ ] **异步信号量（`AsyncSemaphore`）**<br>- [ ] **组合器（`WhenAll` / `WhenAny`）** |
| ⚡⚡⚡ | **API** | - [ ] **协作式取消（`CancellationToken`）** |